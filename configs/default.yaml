# Drift Detector Configuration

collector:
  files:
    enabled: true
    paths:
      - /etc
      - /opt/app/config
    exclude_paths:
      - ".*\\.log$"
      - ".*\\.tmp$"
      - "/etc/mtab"
      - "/etc/resolv.conf"
    follow_links: false
    max_depth: 10
    hash_algo: sha256

  env_vars:
    enabled: true
    include:
      - "^APP_.*"
      - "^DB_.*"
      - "^REDIS_.*"
      - "^AWS_.*"
    exclude:
      - ".*SECRET.*"
      - ".*PASSWORD.*"
      - ".*KEY.*"
    mask_secrets: true

  process_env_vars:
    enabled: true
    processes:
      - node
      - php
      - python
      - python3
      - ruby
      - java
    max_processes: 20
    mask_secrets: true
    exclude:
      - ".*SECRET.*"
      - ".*PASSWORD.*"
      - ".*KEY.*"

  packages:
    enabled: true
    managers:
      - dpkg
      - pip
      - npm

  network:
    enabled: true
    interfaces: true
    routes: true
    dns: true
    firewall_rules: false

  docker:
    enabled: true
    containers: true
    images: true
    volumes: false
    networks: false
    socket_path: /var/run/docker.sock

  system_resources:
    enabled: true
    cpu: true
    memory: true
    disks: true
    load: true

  scheduled_tasks:
    enabled: true
    cron_jobs: true
    systemd_timers: true
    launchd_jobs: true

  certificates:
    enabled: true
    paths:
      - /etc/ssl/certs
      - /etc/letsencrypt
      - /etc/kubernetes
      - /usr/local/share/ca-certificates
    extensions:
      - .pem
      - .crt
      - .cer
      - .key
      - .p12
      - .pfx
    days_threshold: 30

  users_groups:
    enabled: true
    users: true
    groups: true
    sudo_rules: true

  services:
    enabled: true
    include:
      - "nginx"
      - "postgresql"
      - "redis"
      - "app-.*"
    exclude:
      - ".*\\.timer$"
    init_type: systemd

severity_rules:
  critical_packages:
    - nginx
    - postgresql
    - redis
  critical_services:
    - nginx
    - postgresql
    - redis
    - app-server
  critical_files:
    - /etc/nginx/nginx.conf
    - /etc/postgresql/*/postgresql.conf
  critical_env_vars:
    - DATABASE_URL
    - REDIS_URL

output:
  format: table # json, yaml, table, text
  color: true

storage:
  type: file
  path: /var/lib/drift-detector/snapshots
